<!-- frontend/login.html -->
<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <title>로그인</title>
    <link rel="stylesheet" href="./css/style.css" />

    <style>
      .auth-container {
        max-width: 420px;
        margin: 40px auto;
        padding: 0 10px;
      }

      /* 체크박스 + 텍스트 정렬 */
      .checkbox-row {
        display: flex;
        align-items: center; /* ⭐ 수평 정렬 */
        gap: 8px; /* 체크박스와 텍스트 간격 */
        margin: 10px 0 15px;
        font-size: 14px;
      }

      .checkbox-row input[type="checkbox"] {
        width: 18px;
        height: 18px;
        cursor: pointer;
      }

      /* 로그인 버튼 */
      .auth-button {
        width: 100%;
        padding: 12px;
        font-size: 16px;
        border-radius: 8px;
      }

      /* 회원가입 버튼 */
      .secondary-button {
        margin-top: 10px;
        width: 100%;
        padding: 12px;
        font-size: 15px;
        border-radius: 8px;
        border: 1px solid #ccc;
        background: #f5f5f5;
        cursor: pointer;
      }
      .secondary-button:hover {
        background: #e9e9e9;
      }
    </style>
  </head>

  <body class="page-body">
    <header class="page-header">
      <h1>로그인</h1>
    </header>

    <main class="auth-container">
      <form id="loginForm" class="auth-form">
        <h2>나만의 글쓰기</h2>

        <label>아이디</label>
        <input type="text" name="userid" required />

        <label>비밀번호</label>
        <input type="password" name="password" required />

        <!-- 수정된 체크박스 영역 -->
        <label class="checkbox-row">
          <input type="checkbox" id="keepLogin" />
          로그인 상태 유지
        </label>

        <button type="submit" class="auth-button">로그인</button>

        <button type="button" class="secondary-button" id="goSignupBtn">
          회원가입
        </button>
        <p style="text-align: center; margin-top: 10px; color: #888">
          로그인이 안될 시, 새로고침 후 재시도 하세요.
        </p>

        <p id="loginMessage" class="auth-message"></p>
      </form>
    </main>

    <script type="module">
      import { login, saveToken } from "./js/api.js";

      const form = document.getElementById("loginForm");
      const msgEl = document.getElementById("loginMessage");
      const goSignup = document.getElementById("goSignupBtn");

      goSignup.addEventListener("click", () => {
        window.location.href = "./index.html";
      });

      form.addEventListener("submit", async (e) => {
        e.preventDefault();
        msgEl.textContent = "";

        const userid = form.userid.value;
        const password = form.password.value;

        try {
          const data = await login({ userid, password });
          saveToken(data.token);
          msgEl.textContent = "로그인 성공!";

          setTimeout(() => {
            window.location.href = "./posts.html";
          }, 700);
        } catch (err) {
          msgEl.textContent = "로그인 실패: " + err.message;
        }
      });
    </script>
  </body>
</html>
