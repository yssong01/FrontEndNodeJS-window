<!-- frontend/signup.html -->
<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <title>회원가입</title>
    <link rel="stylesheet" href="./css/style.css" />

    <style>
      .auth-container {
        max-width: 420px;
        margin: 40px auto;
        padding: 0 15px;
      }

      .link-row {
        text-align: center;
        margin-top: 15px;
        font-size: 14px;
      }

      .link-row a {
        margin-left: 5px;
        color: #0b7dda;
        text-decoration: underline;
      }
    </style>
  </head>

  <body class="page-body">
    <header class="page-header">
      <h1>회원가입</h1>
    </header>

    <main class="auth-container">
      <form id="signupForm" class="auth-form">
        <h2>회원가입 테스트</h2>
        <label>아이디</label>
        <input
          type="text"
          name="userid"
          placeholder="영문/숫자/특수기호(_ . -) 사용 가능"
          required
        />

        <label>비밀번호</label>
        <input
          type="password"
          name="password"
          placeholder="영문/숫자/특수기호(!@#$%^&*) 6자 이상"
          required
        />

        <label>이름</label>
        <input type="text" name="name" placeholder="홍길동" required />

        <label>이메일</label>
        <input
          type="email"
          name="email"
          placeholder="yourid@example.com"
          required
        />

        <label>프로필 URL (선택)</label>
        <input
          type="text"
          name="url"
          placeholder="https://example.com/profile.jpg"
        />

        <button type="submit" class="auth-button">가입하기</button>

        <div class="link-row">
          이미 계정이 있으신가요?
          <a href="./login.html">로그인</a>
        </div>
        <p style="text-align: center; margin-top: 10px; color: #888">
          [회원가입] 클릭 후, 몇 초 동안 딜레이가 있습니다.
        </p>

        <p id="signupMessage" class="auth-message"></p>
      </form>
    </main>

    <script type="module">
      import { signup } from "./js/api.js";

      const form = document.getElementById("signupForm");
      const msgEl = document.getElementById("signupMessage");

      form.addEventListener("submit", async (e) => {
        e.preventDefault();
        msgEl.textContent = "";

        const formData = new FormData(form);
        const payload = Object.fromEntries(formData.entries());

        try {
          await signup(payload);
          msgEl.textContent = "회원가입 성공! 로그인 화면으로 이동합니다.";
          setTimeout(() => {
            window.location.href = "./login.html";
          }, 800);
        } catch (err) {
          msgEl.textContent = "회원가입 실패: " + err.message;
        }
      });
    </script>
  </body>
</html>
